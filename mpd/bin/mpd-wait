#!/bin/sh
set -e

usage() {
	cat <<-EOF 1>&2
		usage: mpd-wait [nsongs]

		mpd-wait waits for nsongs (default: 1) songs to finish playing
		in MPD before returning.  Use the MPD_HOST and MPD_PORT
		environment variables to specify alternative server details.
	EOF
	exit 2
}

nsongs=1
if test "$1" -eq 0 -o "$1" -ne 0 2>/dev/null; then
	nsongs="$1"
	shift
elif test $# -gt 0; then
	usage
fi

i=1
while test $i -le $nsongs; do
	mpc current --wait > /dev/null
	i=$((i + 1))
done
unset i
